{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!

    @template theme_so7ob/navbar

    This template renders the top navbar.

    Example context (json):
    {
        "output": {
            "should_display_navbar_logo": true,
            "get_compact_logo_url": "http://placekitten.com/50/50",
            "custom_menu": "<li>..</li>",
            "page_heading_menu": "<li>..</li>",
            "search_box": "<div><input type='text'></div>",
            "navbar_plugin_output": "<div class='dropdown'>Messaging</div>",
            "user_menu": "<div class='dropdown'>John Doe</div>"
        },
        "config": {
            "wwwroot": "#",
            "homeurl": "/my/"
        },
        "sitename": "Moodle Site",
        "mobileprimarynav": [
            {
                "text": "Dashboard",
                "url": "/my",
                "isactive": true
            },
            {
                "text": "Site home",
                "url": "/",
                "isactive": false
            },
            {
                "text": "My courses",
                "url": "/course",
                "isactive": false
            }
        ]
    }
}}
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm py-3" aria-label="Main navigation">
    <div class="container-fluid">
        <div class="d-flex align-items-center">
            <!-- Drawer toggle for mobile (maintain original side drawer behaviour) -->
            <button class="navbar-toggler me-2 aabtn d-block d-md-none px-1 my-1 border-0"
                data-toggler="drawers" data-action="toggle" data-target="theme_boost-drawers-primary">
                <span class="navbar-toggler-icon"></span>
                <span class="sr-only">{{#str}}sidepanel, core{{/str}}</span>
            </button>
            <!-- Brand / Logo -->
            <a href="{{{ config.homeurl }}}" class="navbar-brand d-flex align-items-center m-0 me-3 p-0 fw-bold">
                {{# output.should_display_logo }}
                    <img src="{{output.get_logo}}" alt="{{sitename}}" class="me-2" height="40">
                {{/ output.should_display_logo }}
                {{^ output.should_display_logo }}
                    {{{ sitename }}}
                {{/ output.should_display_logo }}
            </a>
        </div>
        <!-- Navbar collapse toggle -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#so7ob-navbar"
            aria-controls="so7ob-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="so7ob-navbar">
            <!-- Primary navigation menu (custom and more menu) -->
            {{#primarymoremenu}}
                <div class="primary-navigation me-auto">
                    {{> core/moremenu}}
                </div>
            {{/primarymoremenu}}
            {{^primarymoremenu}}
                <div class="navbar-nav me-auto">
                    {{{ output.page_heading_menu }}}
                </div>
            {{/primarymoremenu}}
            <!-- Search box -->
            {{# output.search_box }}
                <div class="me-3 d-flex align-items-center">
                    {{{ output.search_box }}}
                </div>
            {{/output.search_box}}
            <!-- Language menu -->
            {{#langmenu}}
                <div class="d-flex align-items-center me-2">
                    {{> theme_boost/language_menu }}
                </div>
            {{/langmenu}}
            <!-- Dark mode toggle button -->
            <button id="dark-mode-toggle" type="button" class="btn btn-outline-secondary me-2">
                <i class="fa fa-moon"></i>
                <span class="sr-only">Toggle dark mode</span>
            </button>
            <!-- Plugin output (e.g. messaging) -->
            {{{ output.navbar_plugin_output }}}
            <!-- User menu and edit switch -->
            <div class="d-flex align-items-center ms-2">
                {{#usermenu}}
                    {{> core/user_menu }}
                {{/usermenu}}
                {{{ output.edit_switch }}}
            </div>
        </div>
    </div>
</nav>

{{#secondarymoremenu}}
    <div class="secondary-navigation d-print-none so7ob">
        <div class="so7ob-container-fluid">
            {{> core/moremenu}}
        </div>
    </div>
{{/secondarymoremenu}}

<!-- Mobile primary drawer still loaded from Boost -->
{{> theme_boost/primary-drawer-mobile }}
